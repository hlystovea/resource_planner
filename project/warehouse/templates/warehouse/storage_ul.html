{% load static %}
<li>
    <a class="icon-link align-middle" href="#"
        hx-get="{% url 'warehouse:storage-li' parent_storage.pk %}"
        hx-target="closest li"
        hx-swap="outerHTML"
    >
        <img src="{% static 'icons/dash-square.svg' %}" height="16" fill="currentColor" class="bi bi-dash-square">
    </a>
    <span>{{ parent_storage.name }}</span>

    <ul class="list">
        {% for storage in storage_list %}
            <li>
                {% if storage.storage_count %}
                    <a class="icon-link align-middle" href="#"
                        hx-get="{% url 'warehouse:storage-list' %}?storage={{ storage.pk }}"
                        hx-target="closest li"
                        hx-swap="outerHTML"
                    >
                        <img src="{% static 'icons/plus-square.svg' %}" height="16" fill="currentColor" class="bi bi-plus-square">
                    </a>
                {% endif %}
                <span {% if not storage.storage_count %}style="margin-left: 21px;" {% endif %}>
                    {{ storage.name }}
                </span>
                {% if storage.storage_count %}
                    <span class="position-absolute badge bg-danger rounded-pill ms-1" style="--bs-badge-font-size: .5rem;">
                        {{ storage.storage_count }}
                    </span>
                {% endif %}
                {% if user.is_authenticated %}
                    <div class="row ms-3">
                        <a class="icon-link align-middle" role="button"
                            hx-get="{% url 'warehouse:storage-update' storage.pk %}"
                            hx-target="closest li"
                            hx-swap="outerHTML"
                        >
                            <img src="{% static 'icons/pen.svg' %}" height="16" fill="currentColor" class="bi bi-pen">
                        </a>
                        <a class="icon-link align-middle" role="button"
                            hx-delete="{% url 'warehouse:storage-delete' storage.pk %}"
                            hx-target="closest li"
                            hx-swap="outerHTML"
                            hx-confirm="Вы уверены, что хотите удалить место хранения и все вложенные элементы?"
                        >
                            <img src="{% static 'icons/trash3.svg' %}" height="16" fill="currentColor" class="bi bi-trash3">
                        </a>
                    </div>
                {% endif %}
            </li>
        {% endfor %}
        <li>
            {% if user.is_authenticated %}
                {{ form.name }}
                <a class="icon-link align-middle" role="button"
                    hx-post="{% url 'warehouse:storage-add-storage' parent_storage.pk %}"
                    hx-target="closest li"
                    hx-swap="beforebegin"
                    hx-include="previous input"
                >
                    <img src="{% static 'icons/floppy.svg' %}" height="16" fill="currentColor" class="bi bi-floppy">
                </a>
            {% endif %}
        </li>
    </ul>
</li>